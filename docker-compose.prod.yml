version: "3.9"

# Production overrides â€” use with:
#   docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d

services:
  claude-engine:
    build:
      target: production
    volumes: []
    restart: always
    deploy:
      resources:
        limits:
          cpus: "2.0"
          memory: 2G

  postgres:
    environment:
      POSTGRES_PASSWORD: ${DATABASE_PASSWORD:?Set DATABASE_PASSWORD}
    deploy:
      resources:
        limits:
          cpus: "1.0"
          memory: 1G

  redis:
    command: redis-server --requirepass ${REDIS_PASSWORD:?Set REDIS_PASSWORD}
    deploy:
      resources:
        limits:
          cpus: "0.5"
          memory: 512M

  superset:
    restart: always
    deploy:
      resources:
        limits:
          cpus: "1.0"
          memory: 1G
